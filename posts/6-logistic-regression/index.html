<!DOCTYPE html>
<html lang='en' ><meta charset="utf-8">
<meta name="viewport" content="width=device-width">


<title>Logistic Regression | ME</title>
<link rel="stylesheet" href="/css/eureka.min.css">
<script defer src="/js/eureka.min.js"></script>

<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preload"
  href="https://fonts.googleapis.com/css2?family=Lora:wght@400;600;700&family=Noto+Serif+SC:wght@400;600;700&display=swap"
  as="style" onload="this.onload=null;this.rel='stylesheet'">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.1.0/build/styles/solarized-light.min.css%25!%28EXTRA%20string=solarized-light%29"
   media="print"
  onload="this.media='all';this.onload=null" crossorigin>
<script defer src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.1.0/build/highlight.min.js"
   crossorigin></script>

  <script defer src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.1.0/build/languages/dart.min.js"
     crossorigin></script>

<script defer src="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.14.0/js/all.min.js"
   integrity="sha256-uNYoXefWRqv&#43;PsIF/OflNmwtKM4lStn9yrz2gVl6ymo="  crossorigin></script>


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"
   integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3&#43;Aro6EYUG4&#43;cU&#43;KJWu/X"  media="print"
  onload="this.media='all';this.onload=null" crossorigin>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" 
  integrity="sha384-g7c&#43;Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI&#43;sEnkvrMWph2EDg4"  crossorigin></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js"
   integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC&#43;Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa"  crossorigin></script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    renderMathInElement(document.body, {
      delimiters: [
        { left: "$$", right: "$$", display: true },
        { left: "$", right: "$", display: false },
        { left: "\\(", right: "\\)", display: false },
        { left: "\\[", right: "\\]", display: true }
      ],
    });
  });
</script>


<link rel="icon" type="image/png" sizes="32x32" href="/images/icon_hu64421c6c7700f606f0ad45d807017b09_5843_32x32_fill_box_center_2.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/icon_hu64421c6c7700f606f0ad45d807017b09_5843_180x180_fill_box_center_2.png">

<meta name="description"
  content="Logistic regression Logistic regression unlike linear regression is well suited for classification type problems. The difference lies in the way data is fitted, instead of a linear (hyper)plane it is fitted using the following exponential function (also known as the sigmoid function):
 \[\begin{aligned} h_{\theta}(x) = \dfrac{1}{1 &#43; \exp{(-\theta^Tx)}} \end{aligned}\]  This function has the nice property that, its output is bound between zero and one. This is a usefull property when trying to model the (posterior) probability of something.">
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
      "@type": "ListItem",
      "position": 1 ,
      "name":"Posts",
      "item":"/posts/"},{
      "@type": "ListItem",
      "position": 2 ,
      "name":"Logistic Regression",
      "item":"/posts/6-logistic-regression/"}]
}
</script>



<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "/posts/6-logistic-regression/"
    },
    "headline": "Logistic Regression | ME","datePublished": "2020-01-15T20:24:51+01:00",
    "dateModified": "2020-01-15T20:24:51+01:00",
    "wordCount":  467 ,
    "publisher": {
        "@type": "Person",
        "name": "C. Wang",
        "logo": {
            "@type": "ImageObject",
            "url": "/images/icon.png"
        }
        },
    "description": "Logistic regression Logistic regression unlike linear regression is well suited for classification type problems. The difference lies in the way data is fitted, instead of a linear (hyper)plane it is fitted using the following exponential function (also known as the sigmoid function):\n \\[\\begin{aligned} h_{\\theta}(x) = \\dfrac{1}{1 \u002b \\exp{(-\\theta^Tx)}} \\end{aligned}\\]  This function has the nice property that, its output is bound between zero and one. This is a usefull property when trying to model the (posterior) probability of something."
}
</script><meta property="og:title" content="Logistic Regression | ME" />
<meta property="og:type" content="article" />


<meta property="og:image" content="/images/icon.png">


<meta property="og:url" content="/posts/6-logistic-regression/" />




<meta property="og:description" content="Logistic regression Logistic regression unlike linear regression is well suited for classification type problems. The difference lies in the way data is fitted, instead of a linear (hyper)plane it is fitted using the following exponential function (also known as the sigmoid function):
 \[\begin{aligned} h_{\theta}(x) = \dfrac{1}{1 &#43; \exp{(-\theta^Tx)}} \end{aligned}\]  This function has the nice property that, its output is bound between zero and one. This is a usefull property when trying to model the (posterior) probability of something." />




<meta property="og:locale" content="en" />




<meta property="og:site_name" content="ME" />






<meta property="article:published_time" content="2020-01-15T20:24:51&#43;01:00" />


<meta property="article:modified_time" content="2020-01-15T20:24:51&#43;01:00" />



<meta property="article:section" content="posts" />




<body class="flex flex-col min-h-screen">
  <header class="fixed flex items-center w-full min-h-16 pl-scrollbar z-50 bg-secondary-bg shadow-sm">
    <div class="w-full max-w-screen-xl mx-auto"><script>
    let storageColorScheme = localStorage.getItem("lightDarkMode")
    if (((storageColorScheme == 'Auto' || storageColorScheme == null) && window.matchMedia("(prefers-color-scheme: dark)").matches) || storageColorScheme == "Dark") {
        document.getElementsByTagName('html')[0].classList.add('dark')
    }
</script>
<nav class="flex items-center justify-between flex-wrap px-4 py-4 md:py-0">
    <a href="/" class="mr-6 text-primary-text text-xl font-bold">ME</a>
    <button id="navbar-btn" class="md:hidden flex items-center px-3 py-2" aria-label="Open Navbar">
        <i class="fas fa-bars"></i>
    </button>

    <div id="target"
        class="hidden block md:flex md:flex-grow md:justify-between md:items-center w-full md:w-auto text-primary-text z-20">
        <div class="md:flex md:h-16 text-sm md:flex-grow pb-4 md:pb-0 border-b md:border-b-0">
            <a href="/#about" class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2  border-transparent  mr-4">About</a>
            <a href="/posts/" class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2  selected-menu-item  mr-4">Posts</a>
        </div>

        <div class="flex">
            <div class="relative pt-4 md:pt-0">
                <div class="cursor-pointer hover:text-eureka" id="lightDarkMode">
                    <i class="fas fa-adjust"></i>
                </div>
                <div class="fixed hidden inset-0 opacity-0 h-full w-full cursor-default z-30" id="is-open">
                </div>
                <div class="absolute flex flex-col left-0 md:left-auto right-auto md:right-0 hidden bg-secondary-bg w-48 rounded py-2 border border-tertiary-bg cursor-pointer z-40"
                    id='lightDarkOptions'>
                    <span class="px-4 py-1 hover:text-eureka">Light</span>
                    <span class="px-4 py-1 hover:text-eureka">Dark</span>
                    <span class="px-4 py-1 hover:text-eureka">Auto</span>
                </div>
            </div>
        </div>
    </div>

    <div class="fixed hidden inset-0 opacity-0 h-full w-full cursor-default z-0" id="is-open-mobile">
    </div>

</nav>
<script>
    let element = document.getElementById('lightDarkMode')
    if (storageColorScheme == null || storageColorScheme == 'Auto') {
        document.addEventListener('DOMContentLoaded', () => {
            switchMode('Auto')
        })
    } else if (storageColorScheme == "Light") {
        element.firstElementChild.classList.remove('fa-adjust')
        element.firstElementChild.setAttribute("data-icon", 'sun')
        element.firstElementChild.classList.add('fa-sun')
    } else if (storageColorScheme == "Dark") {
        element.firstElementChild.classList.remove('fa-adjust')
        element.firstElementChild.setAttribute("data-icon", 'moon')
        element.firstElementChild.classList.add('fa-moon')
    }
    
    document.addEventListener('DOMContentLoaded', () => {
        getcolorscheme();
        switchBurger();
    });
</script></div>
  </header>
  <main class="flex-grow pt-16">
    <div class="pl-scrollbar">
      <div class="w-full max-w-screen-xl lg:px-4 xl:px-8 mx-auto">


<div class="grid grid-cols-2 lg:grid-cols-8 gap-4 lg:pt-12">
    <div
        class="col-span-2 lg:col-start-2 lg:col-span-6 bg-secondary-bg rounded px-6 py-8">
        <h1 class="font-bold text-3xl text-primary-text">Logistic Regression</h1>
        <div class="flex flex-wrap flex-row items-center mt-2 text-tertiary-text">
    <div class="mr-6 my-2">
        <i class="fas fa-calendar mr-1"></i>
        <span>2020-01-15</span>
    </div>
    <div class="mr-6 my-2">
        <i class="fas fa-clock mr-1"></i>
        <span>3 min read</span>
    </div>
    
    

    
</div>
        
        
        

        <div class="content">
            <h3 id="logistic-regression">Logistic regression</h3>
<p>Logistic regression unlike linear regression is well suited for classification type problems. The difference
lies in the way data is fitted, instead of a linear (hyper)plane it is fitted using the following
exponential function (also known as the sigmoid function):</p>
<div>
\[\begin{aligned}
     h_{\theta}(x) = \dfrac{1}{1 + \exp{(-\theta^Tx)}}
\end{aligned}\]
</div>
<p>This function has the nice property that, its output is bound between zero and one. This is a usefull property when trying to
model the (posterior) probability of something. In a two class classification problem, where the output is either a one or a zero,
a bounded function intuitively also makes more sence.</p>
<p>The derivative of $h_{\theta}(x)$ is going to be usefull later on, for gradient descend.</p>
<div>
\[\begin{aligned}
     \dfrac{\delta h_{\theta}(x)}{\delta \theta} &= \dfrac{1}{(1 + \exp{(-\theta^Tx)})^2} \cdot -x \exp{(-\theta^Tx)} \\
     &= \dfrac{1}{(1 + \exp{(-\theta^Tx)})} \cdot -x \dfrac{\exp{(-\theta^Tx)}}{(1 + \exp{(-\theta^Tx)})} \\
     &= \dfrac{1}{1 + \exp{(-\theta^Tx)}} \cdot -x ( \dfrac{1 + \exp{(-\theta^Tx)}}{1 + \exp{(-\theta^Tx)}} - \dfrac{1}{1 + \exp{(-\theta^Tx)}} ) \\
     &= x h_{\theta}(x) (1 - h_{\theta}(x))
\end{aligned}\]
</div>
<p><img src="/images/Logistic_func.png" alt="img"></p>
<h4 id="cost-function">Cost function</h4>
<p>In a two class binary classification example the posterior probability of the logistic regression function is modeled using
the bernoulli distribution:</p>
<div>
\[\begin{aligned}
     p(y_i|x;\theta) &= \begin{cases} h_{ \theta }(x) &: i=1  \\
     1-h_{ \theta }(x) &: i=0 \end{cases} \\
     p(y_i|x;\theta) &= h_{\theta}(x)^{y_i}(1-h_{ \theta }(x))^{1-y_i}
\end{aligned}\]
</div>
<p>The cost function for the logistic regression method will again be formulated based on the likelihood of the data given
the parameter $\theta$. The Likelihood is defined as the cumulitive probability of the correct class for all given training objects.
The likelihood of a dataset (assuming samples were drawn independently):</p>
<div>
\[\begin{aligned}
     L(\theta) &= p(y|x;\theta) \\
     &= \prod_{i=1}^n p(y^{(i)} | x^{(i)}) \\
     &= \prod_{i=1}^n h_{\theta}(x^{(i)})^{y^{(i)}} (1-h_{\theta}(x^{(i)}))^{1-y^{(i)}}
\end{aligned}\]
</div>
<p>To use this likelihood in our gradient descend alogrithm we will transform it in the following way.
Because the gradient descend algorithm optimizes for finding the minimum cost, we will have to take the negative likelihood.
Taking the log of the likelihood will make computations a lot easier without affecting the outcome. Another reason for taking
the log of the likelihood is to prevent the likelihood from converging towards zero very quickly as the dataset volume increases.</p>
<div>
\[\begin{aligned}
     J(\theta) &= - \text{log} \ (L(\theta)) \\
     &= \sum_{i=1}^n -y^{(i)} \text{log} \ ( h_{\theta}(x^{(i)}) ) + (y^{(i)}-1) \text{log} \ (1 - h_{\theta}(x^{(i)}))
\end{aligned}\]
</div>
<h4 id="gradient-descend">Gradient descend</h4>
<p>The update rule for our stochastic gradient descend (one training example) algorithm will look as follows:</p>
<div>
\[\begin{aligned}
     \theta :&= \theta + \alpha \cdot \dfrac{\delta J(\theta)}{\delta \theta} \\
     &= \theta - \alpha \cdot \left( -y \dfrac{1}{h_{\theta}(x)} - (y-1) \dfrac{1}{1 - h_{\theta}(x)} \right) \dfrac{\delta h_{\theta}(x)}{\delta \theta} \\
     &= \theta - \alpha \cdot \left( -y \dfrac{1}{h_{\theta}(x)} - (y-1) \dfrac{1}{1 - h_{\theta}(x)} \right)
  	x h_{\theta}(x) (1 - h_{\theta}(x)) \\
     &= \theta - \alpha \cdot x \cdot ( \ (1-y)h_{\theta}(x) - y(1-h_{\theta}(x)) \ ) \\
     &= \theta + \alpha (y - h_{\theta}(x)) x_j
\end{aligned}\]
</div>

        </div>
        
        
        
        
        
        
        
<div class="flex flex-col md:flex-row md:justify-between -mx-2 mt-4 px-2 pt-4 border-t">
    <div>
        
        <span class="block font-bold">Previous</span>
        <a href="/posts/7-generalized-linear-models/" class="block">Generalized Linear Models</a>
        
    </div>
    <div class="md:text-right mt-4 md:mt-0">
        
        <span class="block font-bold">Next</span>
        <a href="/posts/5-linear-regression/" class="block">Linear Regression</a>
        
    </div>
</div>

        
    </div>
    

    
    
</div>
<script>
    document.addEventListener('DOMContentLoaded', ()=>{
        hljs.initHighlightingOnLoad();
    })
</script>

      </div>
    </div>
    
  </main>
  <footer class="pl-scrollbar">
    <div class="w-full max-w-screen-xl mx-auto"><div class="text-center p-6 pin-b">
    <p class="text-sm text-tertiary-text">&copy; 2021 <a href="https://www.wangchucheng.com/">C. Wang</a> and <a href="https://www.ruiqima.com/">R. Ma</a>
 &middot;  Powered by the <a href="https://github.com/wangchucheng/hugo-eureka" class="hover:text-eureka">Eureka</a> theme for <a href="https://gohugo.io" class="hover:text-eureka">Hugo</a></p>
</div></div>
  </footer>
</body>

</html>